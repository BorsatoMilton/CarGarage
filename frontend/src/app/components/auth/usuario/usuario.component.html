<div class="container my-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h2>LISTA DE USUARIOS</h2>
      <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addUser">Añadir
        Usuario</button>
    </div>
    <table class="table table-hover">
      <thead class="table-dark">
        <tr>
          <th>USUARIO</th>
          <th>NOMBRE</th>
          <th>APELLIDO</th>
          <th>MAIL</th>
          <th>DIRECCION</th>
          <th>TELEFONO</th>
          <th>ROL</th>
          <th>ACCIONES</th>
        </tr>
      </thead>
      <tbody *ngIf="users.length > 0">
        <tr *ngFor="let User of users">
          <td>{{ User.usuario }}</td>
          <td>{{ User.nombre }}</td>
          <td>{{ User.apellido }}</td>
          <td>{{ User.mail }}</td>
          <td>{{ User.direccion }}</td>
          <td>{{ User.telefono }}</td>
          <td>{{ User.rol.nombreRol }}</td>
          <td>
            <button (click)="openModal('editUser', User)" class="btn btn-primary" data-bs-toggle="modal"
              data-bs-target="#editUserModal" id="boton-editar">Editar</button>
              <button (click)="openModal('updatePassword', User)" class="btn btn-warning" data-bs-toggle="modal"
              data-bs-target="#changePaswwordUserModal">Actualizar Clave</button>
            <button (click)="openModal('removeUser', User)" class="btn btn-danger" data-bs-toggle="modal"
              data-bs-target="#removeUserModal" id="boton-eliminar">Eliminar</button>
          </td>
        </tr>
      </tbody>
      <p *ngIf="users.length === 0" class="text-center text-muted">No hay usuarios</p>
    </table>
</div>
    <div class="modal fade" id="addUser" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Nuevo Usuario</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form [formGroup]="userForm" (ngSubmit)="addUser()">
              <div class="row">
                <div class="col-md-6">
                  <label for="usuario">Usuario</label>
                  <input type="text" formControlName="usuario" id="usuario" class="form-control" required>
                  <label for="clave">Clave</label>
                  <input type="password" formControlName="clave" id="clave" class="form-control" required>
                </div>
                <div class="col-md-6">
                  <label for="nombre">Nombre</label>
                  <input type="text" formControlName="nombre" id="nombre" class="form-control">
                  <label for="apellido">Apellido</label>
                  <input type="text" formControlName="apellido" id="apellido"class="form-control">
                </div>
              </div>
              <div class="row">
              <div class="col-md-6">
                  <label for="mail">Mail</label>
                  <input type="email" formControlName="mail" id="mail" class="form-control" required>
                  <label for="direccion">Direccion</label>
                  <input type="text" formControlName="direccion" id="direccion"class="form-control">
              </div>
              <div class="col-md-6">
                  <label for="telefono">Telefono</label>
                  <input type="text" formControlName="telefono" id="telefono" class="form-control" required>
              </div>
              </div>
              <div class="form-group">
                <label for="rol">Rol</label>
                <select id="rol" formControlName="rol" class="form-control">
                  <option *ngFor="let rol of roles" [value]="rol.id">{{ rol.nombreRol }}</option>
                </select>
              </div>
            <div class="modal-footer mt-3">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="submit" class="btn btn-primary" [disabled]="userForm.invalid">Guardar</button>
            </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  
  
    <div class="modal fade" id="removeUserModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">Eliminar Usuario</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
        <p><strong>¿Estás seguro de que deseas eliminar el siguiente usuario?</strong></p>
        <p><strong>Usuario:</strong> {{ selectedUser?.usuario }}</p>
        <button class="btn btn-secondary" (click)="closeModal('removeUser')" data-bs-dismiss="modal">Cancelar</button>
        <button class="btn btn-danger" (click)="removeUser(selectedUser, 'removeUser')" data-bs-dismiss="modal">Eliminar</button>
      </div>
    </div>
  </div>
</div>
  
    <div class="modal fade" id="editUserModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">Editar Usuario</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
        <form [formGroup]="userForm" (ngSubmit)="editUser()">
          <div class="row">
          <div class="col-md-6">
            <label for="usuario">Usuario</label>
            <input type="text" formControlName="usuario" id="usuario" name="usuario" class="form-control" required>
            <label for="nombre">Nombre</label>
            <input type="text" formControlName="nombre" id="nombre" name="nombre" class="form-control">
          </div>
          <div class="col-md-6">
            <label for="apellido">Apellido</label>
            <input type="text" formControlName="apellido" id="apellido" name="apellido"
              class="form-control">
            <label for="mail">Mail</label>
            <input type="email" formControlName="mail" id="mail" name="mail" class="form-control" required>
          </div>
          </div>
          <div class="row">
          <div class="col-md-6">
            <label for="direccion">Direccion</label>
            <input type="text" formControlName="direccion" id="direccion" name="direccion"
              class="form-control">
          </div>
          <div class="col-md-6">
            <label for="telefono">Telefono</label>
            <input type="text" formControlName="telefono" id="telefono" name="telefono" class="form-control" required>
          </div>
          </div>
          <div class="form-group">
            <label for="rol">Rol</label>
            <select id="rol" formControlName="rol" class="form-control">
              <option *ngFor="let rol of roles" [value]="rol.id">{{ rol.nombreRol }}</option>
            </select>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" (click)="closeModal('editUser')" data-bs-dismiss="modal">Cancelar</button>
            <button type="submit" class="btn btn-primary" (click)="editUser()" data-bs-dismiss="modal">Guardar cambios</button>
          </div>
  
        </form>
      </div>
    </div>
  </div>
</div>


    <div id="updatePassword" class="modalChanged">
      <div class="modal-contentChanged">
        <span class="close" (click)="closeModal('updatePassword')">&times;</span>
        <h2>Cambiar Contraseña Usuario</h2>
        <form [formGroup]="userForm" (ngSubmit)="updatePassword()">
          <div class="form-group">
            <label for="clave">Nueva Clave</label>
            <input type="password" formControlName="clave" id="clave" name="clave" class="form-control" required>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" (click)="closeModal('updatePassword')">Cancelar</button>
            <button type="submit" class="btn btn-primary" [disabled]="userForm.invalid">Guardar cambios</button>
          </div>
        </form>
      </div>
    </div>